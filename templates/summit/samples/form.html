{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quick Registration</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    body {
      background: #f8f9fa;
      color: #212529;
    }
    @media (prefers-color-scheme: dark) {
      body {
        background: #121212;
        color: #f1f1f1;
      }
      .form-control, .form-select, .form-check-label {
        background-color: #1e1e1e;
        color: #f1f1f1;
        border-color: #444;
      }
      .form-control::placeholder {
        color: #aaa;
      }
      .card {
        background-color: #1c1c1c;
        border-color: #333;
      }
    }
    .form-icon {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: #6c757d;
    }
    .input-with-icon {
      position: relative;
    }
    .input-with-icon input {
      padding-left: 2.2rem;
    }
  </style>
</head>
<body>
  <div class="container my-5">
    <div class="card shadow p-4 mx-auto" style="max-width: 700px;">
      <h2 class="mb-4 text-center">Quick Registration</h2>

      <form id="registrationForm" method="post" novalidate>
        {% csrf_token %}

        <!-- Full Name -->
        <div class="mb-3 input-with-icon">
          <i class="fa fa-user form-icon"></i>
          {{ form.full_name }}
          {% if form.full_name.errors %}
            <div class="text-danger small">{{ form.full_name.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Email -->
        <div class="mb-3 input-with-icon">
          <i class="fa fa-envelope form-icon"></i>
          {{ form.email }}
          {% if form.email.errors %}
            <div class="text-danger small">{{ form.email.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Phone -->
        <div class="mb-3 input-with-icon">
          <i class="fa fa-phone form-icon"></i>
          {{ form.phone }}
          {% if form.phone.errors %}
            <div class="text-danger small">{{ form.phone.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Organization -->
        <div class="mb-3 input-with-icon">
          <i class="fa fa-building form-icon"></i>
          {{ form.organization }}
          {% if form.organization.errors %}
            <div class="text-danger small">{{ form.organization.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Job Title -->
        <div class="mb-3 input-with-icon">
          <i class="fa fa-briefcase form-icon"></i>
          {{ form.job_title }}
          {% if form.job_title.errors %}
            <div class="text-danger small">{{ form.job_title.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Category -->
        <div class="mb-3">
          <label class="form-label">Category</label>
          {{ form.category }}
          {% if form.category.errors %}
            <div class="text-danger small">{{ form.category.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Other Category (hidden until 'Other' selected) -->
        <div class="mb-3" id="other-category-field" style="display:none;">
          {{ form.other_category }}
        </div>

        <!-- Interests -->
        <div class="mb-3">
          <label class="form-label">Interests</label>
          <div id="id_interests">
            {% for checkbox in form.interests %}
              <div class="form-check">
                {{ checkbox.tag }} 
                <label class="form-check-label">{{ checkbox.choice_label }}</label>
              </div>
            {% endfor %}
          </div>
          {% if form.interests.errors %}
            <div class="text-danger small">{{ form.interests.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Other Interest (hidden until 'Other' checked) -->
        <div class="mb-3" id="other-interest-field" style="display:none;">
          {{ form.other_interest }}
        </div>

        <!-- Accessibility -->
        <div class="mb-3">
          {{ form.accessibility_needs }}
          {% if form.accessibility_needs.errors %}
            <div class="text-danger small">{{ form.accessibility_needs.errors|striptags }}</div>
          {% endif %}
        </div>

        <!-- Updates opt-in -->
        <div class="form-check mb-3">
          {{ form.updates_opt_in }}
          <label class="form-check-label">Receive updates</label>
        </div>

        <button type="submit" class="btn btn-primary w-100">
          <i class="fa fa-paper-plane me-1"></i> Submit
        </button>
      </form>
    </div>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', function () {
    const categorySelect = document.getElementById('id_category');
    const otherCategoryField = document.getElementById('other-category-field');

    const interestsCheckboxes = document.querySelectorAll('#id_interests input[type=checkbox]');
    const otherInterestField = document.getElementById('other-interest-field');

    function toggleOtherCategory() {
      if (categorySelect.value === 'Other') {
        otherCategoryField.style.display = 'block';
      } else {
        otherCategoryField.style.display = 'none';
      }
    }

    function toggleOtherInterest() {
      const otherChecked = Array.from(interestsCheckboxes).some(
        cb => cb.value === 'Other' && cb.checked
      );
      if (otherChecked) {
        otherInterestField.style.display = 'block';
      } else {
        otherInterestField.style.display = 'none';
      }
    }

    if (categorySelect) {
      categorySelect.addEventListener('change', toggleOtherCategory);
      toggleOtherCategory();
    }

    if (interestsCheckboxes.length > 0) {
      interestsCheckboxes.forEach(cb => cb.addEventListener('change', toggleOtherInterest));
      toggleOtherInterest();
    }
  });
  </script>
</body>
</html>
